import{p as e,a as t,r as l,b as n,w as r,o as s,c as a,d as o,e as i,f as d,v as c,u,g as p,h as g,t as h,i as b,j as m,k as w,l as x,m as y}from"./vendor.8a85572e.js";e("data-v-63e40a6b");const k={class:"lg:w-1/2 md:w-2/3 sm:w-11/12 mx-auto z-10"},v={class:"pt-5 mb-5 dark:text-white"},f=i("b",null,"Paste transcript here:",-1),C=m(),E=i("br",null,null,-1),I=m(),L={class:"dark:text-white my-4"},B=i("b",null,"Help Menu",-1),F=i("br",null,null,-1),H=m(" Left Alt = back 4s"),S=i("br",null,null,-1),$=m(" Space = play/pause"),A=i("br",null,null,-1),M=m(" Down = show the current word answer"),T=i("br",null,null,-1),D=m(" Tab = Next word"),j=i("br",null,null,-1),U=m(" Shift Tab / Backspace = Back word"),W=i("br",null,null,-1),P=m(" F1/F2 = Decrease/Increase audio speed by 0.1"),O=i("br",null,null,-1),R=m(" F3 = Check Answer"),V=i("br",null,null,-1),_=m(" F4 = Toggle hint (show/hide the word length)"),q=i("br",null,null,-1),z={class:"dark:text-white text-sm my-2"},K={key:0,class:"dark:text-white mt-1 font-bold text-justify"},N={class:"dark:text-white"},Z={class:"text-green-500 mx-10"},G={class:"text-red-500"},J={class:"text-pink-500 mx-10"},Q={class:"text-yellow-500"},X={class:"my-5 break-normal dark:text-white"},Y=i("br",null,null,-1);t();const ee={expose:[],setup(e){const t=w(),m=t.appContext.config.globalProperties.document,y=t.appContext.config.globalProperties.window,ee=l(null),te=n({ratio:1,nWords:-1,hint:!1,useMaxLength:!0,showHelp:!1,showAnswer:!1,isChinese:!1}),le=n({src:"",speed:1});r((()=>le.speed),(e=>{ee.value.playbackRate=e})),s((()=>{m.addEventListener("keydown",(e=>{"F1"==e.key?(e.preventDefault(),le.speed-=.1):"F2"==e.key?(e.preventDefault(),le.speed+=.1):"F3"==e.key?(e.preventDefault(),ue()):"F4"==e.key&&(e.preventDefault(),ie())}))}));const ne=e=>{let t=e.target.files[0];const l=URL.createObjectURL(t);le.src=l},re=()=>{m.getElementById("audio-input").click()},se=n({words:{}}),ae=e=>Math.random()<te.ratio?`[${e}]`:e,oe=()=>{"dark"===localStorage.theme||!("theme"in localStorage)&&y.matchMedia("(prefers-color-scheme: dark)").matches?(m.documentElement.classList.add("dark"),localStorage.theme="light"):(m.documentElement.classList.remove("dark"),localStorage.theme="dark")},ie=()=>{te.hint=!te.hint;let e=m.querySelectorAll(".hint");for(let t=0;t<e.length;t++){let l=e[t];te.hint?l.style.display="block":l.style.display="none"}},de=e=>{if(Math.random()<te.ratio&&"br"!=e){te.nWords++,se.words[`@${te.nWords}`]=e;let t=10,l=e.length,n="";return te.isChinese&&(l=x(e)[0][0],n="text-5xl",t=30),`\n        <div class="inline-block dark:text-white font-mono">\n            <div class="border-b-2 mr-1 inline-block border-blue-500 text-lg">\n                <input\n                    ref="ref-${te.nWords}"\n                    id="@${te.nWords}"\n                    class="outline-none dark:bg-gray-900 bg-gray-200 text-center mt-2 ${n}"\n                    style="width: ${(e.length+1)*t}px;"\n                    ${te.useMaxLength?`maxlength="${e.length}"`:""}\n                />\n            </div>\n            <div class="hint text-center text-xs" style="display: none">${l}</div>\n        </div>`}return e},ce=n({total:0,wrong:0,correct:0,empty:0,hint:0,show:!1}),ue=()=>{te.showAnswer=!te.showAnswer,Object.assign(ce,{total:0,wrong:0,correct:0,empty:0,hint:0}),ce.total=Object.keys(se.words).length,ce.show=!0;for(let e in se.words){let t=m.getElementById(e),l=t.value;""!=l&&(l!=se.words[e]?(t.style.color="red",ce.wrong++):""==t.style.color?(t.style.color="limegreen",ce.correct++):"darkgoldenrod"==t.style.color&&ce.hint++),""!=l&&"violet"!=t.style.color||(t.style.color="violet",t.value=se.words[e],ce.empty++)}},pe=n({text:""}),ge=n({text:""}),he=()=>{if(ce.show=!1,pe.text=pe.text.trim(),""==pe.text)return;te.nWords=-1,se.words={};let e="",t="",l="";te.isChinese?(e=pe.text.trim().replace(/(。|；|：|，|”)(?!\s|”)/g,"$1 "),t=e.replace(/(\r\n|\n|\r)/gm," <br/>").replace(/[\p{Script=Hani}]/gu,de),l=e.replace(/[\p{Script=Hani}]/gu,ae)):(e=pe.text.trim().replace(/(\.|;|:|,|”)(?!\s|”|\n)/gu,"$1 "),t=e.replace(/(\r\n|\n|\r)/gm," <br/>").replace(/\b\w+(?:[\'-’]\w+)*\b/g,de),l=e.replace(/\b\w+(?:[\'-’]\w+)*\b/g,ae)),console.log(te.isChinese,e,t,l),ge.text=t,setTimeout((()=>{for(let e in se.words){let t="@"+Math.min(parseInt(e.substring(1))+1,Object.keys(se.words).length-1),l="@"+Math.max(parseInt(e.substring(1))-1,0);m.getElementById(e).addEventListener("input",(t=>{if(!t.data)return;let l=t.target.value,n=t.target.selectionStart-1,r=se.words[e].substring(n,n+1);r.match(/[A-Z]/i)&&r===r.toUpperCase()&&(t.target.value=l.substring(0,l.length-1)+t.data.toUpperCase()),t.target.value=t.target.value.trim()})),m.getElementById(e).addEventListener("keydown",(e=>{if("Backspace"==e.code)switch(e.target.value.length){case 0:m.getElementById(l).focus();break;case 1:e.target.style.color=""}})),m.getElementById(e).addEventListener("keyup",(l=>{l.preventDefault(),l.code.match(/^Key/)?te.isChinese||l.target.value.length==se.words[e].length&&m.getElementById(t).focus():" "==l.key&&""!=le.src?ee.value.paused?ee.value.play():ee.value.pause():"ArrowDown"==l.code?(l.target.value=se.words[e],l.target.style.color="darkgoldenrod"):"AltLeft"==l.code&&(ee.value.currentTime-=4)})),te.isChinese&&m.getElementById(e).addEventListener("input",(e=>{e.preventDefault();let l=e.target.value;/^[\p{Script=Hani}]$/u.test(l)&&m.getElementById(t).focus()}))}m.getElementById("@0").focus(),ee.value.canPlay&&ee.value.play()}),200)};return(e,t)=>(a(),o("div",null,[i("div",k,[i("div",v,[f,C,E,I,d(i("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>u(pe).text=e),class:"dark:bg-black inline-block outline-back dark:outline-white mt-3 w-full h-5"},null,512),[[c,u(pe).text]])]),i("button",{onClick:re,class:"bg-green-500 hover:bg-green-700 text-white py-1 px-2 rounded mr-2 mb-1"},"Add audio"),i("button",{onClick:oe,class:"bg-blue-500 hover:bg-blue-700 text-white py-1 px-2 rounded mr-2"},"Change theme"),i("button",{onClick:ie,class:"bg-blue-500 hover:bg-blue-700 text-white py-1 px-2 rounded mr-2"},"Toggle Hint"),i("button",{onClick:t[2]||(t[2]=e=>u(te).showHelp=!u(te).showHelp),class:"bg-blue-500 hover:bg-blue-700 text-white py-1 px-2 rounded"},"Toggle Help"),d(i("input",{type:"checkbox",id:"chinese",name:"chinese","onUpdate:modelValue":t[3]||(t[3]=e=>u(te).isChinese=e),class:"ml-3 mr-1"},null,512),[[p,u(te).isChinese]]),i("button",{onClick:t[4]||(t[4]=e=>u(te).isChinese=!u(te).isChinese),class:"bg-blue-500 hover:bg-blue-700 text-white py-1 px-2 rounded"},"Is Chinese"),d(i("div",L,[B,F,H,S,$,A,M,T,D,j,U,W,P,O,R,V,_,q],512),[[g,u(te).showHelp]]),i("audio",{ref:ee,src:u(le).src,controls:"",class:"inline w-full dark:bg-blue-200"},null,8,["src"]),i("div",z," Current speed: "+h(u(le).speed.toFixed(1))+"x ",1),i("button",{onClick:he,class:"bg-red-500 hover:bg-red-700 text-white py-2 px-4 rounded mr-2"},"Start!"),i("button",{onClick:ue,class:"bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded mr-2"},"Check Answer"),u(ce).show?(a(),o("div",K,[i("span",N," Total: "+h(u(ce).total),1),i("span",Z," Correct: "+h(u(ce).correct)+" ("+h((u(ce).correct/u(ce).total*100).toFixed(1))+"%) ",1),i("span",G," Wrong: "+h(u(ce).wrong)+" ("+h((u(ce).wrong/u(ce).total*100).toFixed(1))+"%) ",1),i("span",J," Empty: "+h(u(ce).empty)+" ("+h((u(ce).empty/u(ce).total*100).toFixed(1))+"%) ",1),i("span",Q," Use hint: "+h(u(ce).hint)+" ("+h((u(ce).hint/u(ce).total*100).toFixed(1))+"%) ",1)])):b("",!0),i("input",{type:"file",id:"audio-input",class:"hidden",onChange:ne},null,32),i("div",X,[i("div",{innerHTML:u(ge).text,class:"break-normal"},null,8,["innerHTML"])]),Y])]))},__scopeId:"data-v-63e40a6b"};const te=y({expose:[],setup:e=>(e,t)=>(a(),o(ee))});te.config.globalProperties.window=window,te.config.globalProperties.document=document,te.mount("#app");
