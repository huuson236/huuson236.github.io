import{p as e,a as t,r as l,b as n,w as r,o as a,c as s,d as o,e as i,f as d,v as c,u,g as p,h as g,t as h,i as b,j as m,k as w,l as y,m as x}from"./vendor.8a85572e.js";e("data-v-a4a651c4");const v={class:"lg:w-1/2 md:w-2/3 sm:w-11/12 mx-auto z-10"},k={class:"pt-5 mb-5 dark:text-white"},f=i("b",null,"Paste transcript here:",-1),C=m(),E=i("br",null,null,-1),I=m(),L=i("label",{for:"chinese",class:"bg-blue-500 hover:bg-blue-700 text-white py-1 px-2 rounded"},"Is Chinese",-1),B=i("br",null,null,-1),F={class:"dark:text-white my-4"},H=i("b",null,"Help Menu",-1),S=i("br",null,null,-1),A=m(" Left Alt = back 4s"),$=i("br",null,null,-1),M=m(" Space = play/pause"),T=i("br",null,null,-1),D=m(" Down = show the current word answer"),j=i("br",null,null,-1),U=m(" Tab = Next word"),W=i("br",null,null,-1),P=m(" Shift Tab / Backspace = Back word"),O=i("br",null,null,-1),R=m(" F1/F2 = Decrease/Increase audio speed by 0.1"),V=i("br",null,null,-1),_=m(" F3 = Check Answer"),q=i("br",null,null,-1),z=m(" F4 = Toggle hint (show/hide the word length)"),K=i("br",null,null,-1),N={class:"dark:text-white text-sm my-2"},Z={key:0,class:"dark:text-white mt-1 font-bold text-justify"},G={class:"dark:text-white"},J={class:"text-green-500 mx-10"},Q={class:"text-red-500"},X={class:"text-purple-500 mx-10"},Y={class:"text-yellow-500"},ee={class:"my-5 break-normal dark:text-white"},te=i("br",null,null,-1);t();const le={expose:[],setup(e){const t=w(),m=t.appContext.config.globalProperties.document,x=t.appContext.config.globalProperties.window,le=l(null),ne=n({ratio:1,nWords:-1,hint:!1,useMaxLength:!0,showHelp:!1,showAnswer:!1,isChinese:!1}),re=n({src:"",speed:1});r((()=>re.speed),(e=>{le.value.playbackRate=e})),a((()=>{m.addEventListener("keydown",(e=>{"F1"==e.key?(e.preventDefault(),re.speed-=.1):"F2"==e.key?(e.preventDefault(),re.speed+=.1):"F3"==e.key?(e.preventDefault(),ge()):"F4"==e.key&&(e.preventDefault(),ce())}))}));const ae=e=>{let t=e.target.files[0];const l=URL.createObjectURL(t);re.src=l},se=()=>{m.getElementById("audio-input").click()},oe=n({words:{}}),ie=e=>Math.random()<ne.ratio?`[${e}]`:e,de=()=>{"dark"===localStorage.theme||!("theme"in localStorage)&&x.matchMedia("(prefers-color-scheme: dark)").matches?(m.documentElement.classList.add("dark"),localStorage.theme="light"):(m.documentElement.classList.remove("dark"),localStorage.theme="dark")},ce=()=>{ne.hint=!ne.hint;let e=m.querySelectorAll(".hint");for(let t=0;t<e.length;t++){let l=e[t];ne.hint?l.style.display="block":l.style.display="none"}},ue=e=>{if(Math.random()<ne.ratio&&"br"!=e){ne.nWords++,oe.words[`@${ne.nWords}`]=e;let t=10;ne.isChinese&&(t=15);let l=e.length;return ne.isChinese&&(l=y(e)[0][0]),`\n        <div class="inline-block dark:text-white font-mono">\n            <div class="border-b-2 mr-1 inline-block border-blue-500 text-lg">\n                <input\n                    ref="ref-${ne.nWords}"\n                    id="@${ne.nWords}"\n                    class="outline-none dark:bg-gray-900 bg-gray-200 text-center mt-2"\n                    style="width: ${(e.length+1)*t}px;"\n                    ${ne.useMaxLength?`maxlength="${e.length}"`:""}\n                />\n            </div>\n            <div class="hint text-center text-xs" style="display: none">${l}</div>\n        </div>`}return e},pe=n({total:0,wrong:0,correct:0,empty:0,hint:0,show:!1}),ge=()=>{ne.showAnswer=!ne.showAnswer,Object.assign(pe,{total:0,wrong:0,correct:0,empty:0,hint:0}),pe.total=Object.keys(oe.words).length,pe.show=!0;for(let e in oe.words){let t=m.getElementById(e),l=t.value;""!=l&&(l!=oe.words[e]?(t.style.color="red",pe.wrong++):""==t.style.color?(t.style.color="limegreen",pe.correct++):"darkgoldenrod"==t.style.color&&pe.hint++),""!=l&&"violet"!=t.style.color||(t.style.color="violet",t.value=oe.words[e],pe.empty++)}},he=n({text:""}),be=n({text:""}),me=()=>{if(pe.show=!1,he.text=he.text.trim(),""==he.text)return;ne.nWords=-1,oe.words={};let e="",t="",l="";ne.isChinese?(e=he.text.trim().replace(/(。|；|：|，|”)(?!\s|”)/g,"$1 "),t=e.replace(/(\r\n|\n|\r)/gm," <br/>").replace(/[\p{Script=Hani}]/gu,ue),l=e.replace(/[\p{Script=Hani}]/gu,ie)):(e=he.text.trim().replace(/(\.|;|:|,|”)(?!\s|”|\n)/gu,"$1 "),t=e.replace(/(\r\n|\n|\r)/gm," <br/>").replace(/\b\w+(?:[\'-’]\w+)*\b/g,ue),l=e.replace(/\b\w+(?:[\'-’]\w+)*\b/g,ie)),console.log(ne.isChinese,e,t,l),be.text=t,setTimeout((()=>{for(let e in oe.words){let t="@"+Math.min(parseInt(e.substring(1))+1,Object.keys(oe.words).length-1),l="@"+Math.max(parseInt(e.substring(1))-1,0);m.getElementById(e).addEventListener("input",(t=>{if(!t.data)return;let l=t.target.value,n=t.target.selectionStart-1,r=oe.words[e].substring(n,n+1);r.match(/[A-Z]/i)&&r===r.toUpperCase()&&(t.target.value=l.substring(0,l.length-1)+t.data.toUpperCase()),t.target.value=t.target.value.trim()})),m.getElementById(e).addEventListener("keydown",(e=>{if("Backspace"==e.code)switch(e.target.value.length){case 0:m.getElementById(l).focus();break;case 1:e.target.style.color=""}})),m.getElementById(e).addEventListener("keyup",(l=>{l.preventDefault(),l.code.match(/^Key/)?ne.isChinese||l.target.value.length==oe.words[e].length&&m.getElementById(t).focus():" "==l.key&&""!=re.src?le.value.paused?le.value.play():le.value.pause():"ArrowDown"==l.code?(l.target.value=oe.words[e],l.target.style.color="darkgoldenrod"):"AltLeft"==l.code&&(le.value.currentTime-=4)})),ne.isChinese&&m.getElementById(e).addEventListener("input",(e=>{e.preventDefault();let l=e.target.value;/^[\p{Script=Hani}]$/u.test(l)&&m.getElementById(t).focus()}))}m.getElementById("@0").focus(),le.value.canPlay&&le.value.play()}),200)};return(e,t)=>(s(),o("div",null,[i("div",v,[i("div",k,[f,C,E,I,d(i("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>u(he).text=e),class:"dark:bg-black inline-block outline-back dark:outline-white mt-3 w-full h-5"},null,512),[[c,u(he).text]])]),i("button",{onClick:se,class:"bg-green-500 hover:bg-green-700 text-white py-1 px-2 rounded mr-2 mb-1"},"Add audio"),i("button",{onClick:de,class:"bg-blue-500 hover:bg-blue-700 text-white py-1 px-2 rounded mr-2"},"Change theme"),i("button",{onClick:ce,class:"bg-blue-500 hover:bg-blue-700 text-white py-1 px-2 rounded mr-2"},"Toggle Hint"),i("button",{onClick:t[2]||(t[2]=e=>u(ne).showHelp=!u(ne).showHelp),class:"bg-blue-500 hover:bg-blue-700 text-white py-1 px-2 rounded"},"Toggle Help"),d(i("input",{type:"checkbox",id:"chinese",name:"chinese","onUpdate:modelValue":t[3]||(t[3]=e=>u(ne).isChinese=e),class:"ml-3 mr-1"},null,512),[[p,u(ne).isChinese]]),L,B,d(i("div",F,[H,S,A,$,M,T,D,j,U,W,P,O,R,V,_,q,z,K],512),[[g,u(ne).showHelp]]),i("audio",{ref:le,src:u(re).src,controls:"",class:"inline w-full dark:bg-blue-200"},null,8,["src"]),i("div",N," Current speed: "+h(u(re).speed.toFixed(1))+"x ",1),i("button",{onClick:me,class:"bg-red-500 hover:bg-red-700 text-white py-2 px-4 rounded mr-2"},"Start!"),i("button",{onClick:ge,class:"bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded mr-2"},"Check Answer"),u(pe).show?(s(),o("div",Z,[i("span",G," Total: "+h(u(pe).total),1),i("span",J," Correct: "+h(u(pe).correct)+" ("+h((u(pe).correct/u(pe).total*100).toFixed(1))+"%) ",1),i("span",Q," Wrong: "+h(u(pe).wrong)+" ("+h((u(pe).wrong/u(pe).total*100).toFixed(1))+"%) ",1),i("span",X," Empty: "+h(u(pe).empty)+" ("+h((u(pe).empty/u(pe).total*100).toFixed(1))+"%) ",1),i("span",Y," Use hint: "+h(u(pe).hint)+" ("+h((u(pe).hint/u(pe).total*100).toFixed(1))+"%) ",1)])):b("",!0),i("input",{type:"file",id:"audio-input",class:"hidden",accept:"audio/*",onChange:ae},null,32),i("div",ee,[i("div",{innerHTML:u(be).text,class:"break-normal"},null,8,["innerHTML"])]),te])]))},__scopeId:"data-v-a4a651c4"};const ne=x({expose:[],setup:e=>(e,t)=>(s(),o(le))});ne.config.globalProperties.window=window,ne.config.globalProperties.document=document,ne.mount("#app");
